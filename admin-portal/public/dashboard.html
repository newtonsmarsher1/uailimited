<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>UAI Admin Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(to bottom, #2979ff 0%, #e3f0ff 100%);
      margin: 0;
    }
    /* Hamburger styles */
    .hamburger {
      position: fixed;
      top: 24px;
      left: 24px;
      width: 36px;
      height: 36px;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px #2979ff22;
      transition: background 0.2s;
    }
    .hamburger span {
      display: block;
      width: 22px;
      height: 3px;
      background: #2979ff;
      margin: 3px 0;
      border-radius: 2px;
      transition: 0.3s;
    }
    /* Sidebar styles */
    #sidebar-toggle {
      display: none;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: -290px;
      width: 220px;
      height: 100vh;
      background: #1b75db;
      color: #1ea0d3;
      box-shadow: 2px 0 16px #2979ff22;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 32px 0 0 0;
      transition: left 0.3s;
    }
    #sidebar-toggle:checked ~ .sidebar {
      left: 0;
    }
    /* Overlay when sidebar is open */
    .sidebar-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(41,121,255,0.12);
      z-index: 999;
    }
    #sidebar-toggle:checked ~ .sidebar-overlay {
      display: block;
    }
    .sidebar .hexagon {
      width: 60px;
      height: 60px;
      background: #bd7de7;
      clip-path: polygon(25% 6%, 75% 6%, 100% 50%, 75% 94%, 25% 94%, 0% 50%);
      margin-bottom: 12px;
      box-shadow: 0 2px 10px rgba(98, 142, 219, 0.15);
      position: relative;
    }
    .sidebar .uai-in-hex {
      position: absolute;
      top: 0;
      left: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      transform: translate(-50%, 0);
      pointer-events: none;
      z-index: 2;
    }
    .sidebar .uai-in-hex span {
      color: #fff;
      font-size: 2em;
      font-weight: 700;
      letter-spacing: 2px;
      text-shadow: 0 2px 8px #7a09c577, 0 0 2px #4f2b7c;
      display: inline-block;
    }
    .sidebar h2 {
      margin: 0 0 32px 0;
      font-size: 1.2em;
      font-weight: 600;
      letter-spacing: 1px;
      color: #fff;
      text-align: center;
    }
    .side-nav {
      display: flex;
      flex-direction: column;
      gap: 18px;
      width: 100%;
      padding: 0 0 0 0;
      align-items: center;
    }
    .side-nav a {
      display: block;
      width: 170px;
      background: #2979ff;
      color: #fff;
      text-decoration: none;
      font-weight: 500;
      font-size: 1em;
      border-radius: 10px;
      padding: 12px 0;
      text-align: center;
      box-shadow: 0 2px 8px #2979ff22;
      transition: background 0.18s;
    }
    .side-nav a:hover {
      background: #1565c0;
    }
    /* Main content shifts when sidebar is open */
    .main-content {
      max-width: 500px;
      margin: 40px auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 16px #2979ff22;
      padding: 32px 24px;
      transition: filter 0.3s;
      position: relative;
      z-index: 1;
    }
    #sidebar-toggle:checked ~ .main-content {
      filter: blur(2px) brightness(0.95);
      pointer-events: none;
      user-select: none;
    }
    .logo-row {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 32px;
    }
    h1 {
      text-align: center;
      color: #2979ff;
      font-size: 2em;
      margin-bottom: 24px;
    }
    nav {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    a.nav-link {
      display: block;
      background: #2979ff;
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.15em;
      border-radius: 12px;
      padding: 16px 0;
      text-align: center;
      box-shadow: 0 2px 8px #2979ff22;
      transition: background 0.18s;
    }
    a.nav-link:hover {
      background: #1565c0;
    }
    @media (max-width: 700px) {
      body {
        padding-left: 0;
      }
      .main-content {
        margin: 24px 8px;
        padding: 18px 6px;
      }
      .sidebar {
        width: 80vw;
        min-width: 180px;
        max-width: 320px;
      }
      .side-nav a {
        width: 90%;
      }
    }
  </style>
</head>
<body>
  <input type="checkbox" id="sidebar-toggle" style="display:none;">
  <label for="sidebar-toggle" class="hamburger" title="Open navigation">
    <span></span>
    <span></span>
    <span></span>
  </label>
  <div class="sidebar">
    <div class="hexagon">
      <div class="uai-in-hex"><span>UAI</span></div>
    </div>
    <h2>Admin Portal</h2>
    <nav class="side-nav">
      <a href="dashboard.html" style="display: flex; align-items: center; gap: 8px;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><rect x="3" y="3" width="7" height="7" rx="2"/><rect x="14" y="3" width="7" height="7" rx="2"/><rect x="14" y="14" width="7" height="7" rx="2"/><rect x="3" y="14" width="7" height="7" rx="2"/></svg>
        Dashboard
      </a>
      <a href="users.html" style="display: flex; align-items: center; gap: 8px;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><path d="M12 12c2.7 0 8 1.34 8 4v2H4v-2c0-2.66 5.3-4 8-4zm0-2a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>
        Manage Users
      </a>
      <a href="tasks.html" style="display: flex; align-items: center; gap: 8px;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M8 10h8M8 14h4" stroke="#fff" stroke-width="2" fill="none"/></svg>
        Manage Tasks
      </a>
      <a href="withdrawals.html" style="display: flex; align-items: center; gap: 8px;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><path d="M12 3v12m0 0l-4-4m4 4l4-4" stroke="#fff" stroke-width="2" fill="none"/><rect x="4" y="15" width="16" height="6" rx="2"/></svg>
        Manage Withdrawals
      </a>
      <a href="prizes.html" style="display: flex; align-items: center; gap: 8px;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><circle cx="12" cy="8" r="7"/><path d="M5 21h14l-7-7z"/></svg>
        Manage Prizes
      </a>
      <a href="workers.html" style="display: flex; align-items: center; gap: 8px;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><circle cx="12" cy="8" r="4"/><path d="M2 20v-2a8 8 0 0 1 16 0v2"/></svg>
        Manage Workers
      </a>
      <a href="change-password.html" id="control-panel-link" style="display: flex; align-items: center; gap: 8px;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><rect x="6" y="10" width="12" height="10" rx="2"/><path d="M12 16v-4" stroke="#fff" stroke-width="2" fill="none"/><circle cx="12" cy="14" r="1" fill="#fff"/></svg>
        Control Panel
      </a>
      <a href="#" id="logout-btn" style="display: flex; align-items: center; gap: 8px; color: #fff;">
        <svg viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle; fill: #fff;"><path d="M16 13v-2H7V8l-5 4 5 4v-3z"/><path d="M20 3h-8a2 2 0 0 0-2 2v4h2V5h8v14h-8v-4h-2v4a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
        Log Out
      </a>
    </nav>
  </div>
  <label for="sidebar-toggle" class="sidebar-overlay"></label>
  <div class="main-content">
    <div class="logo-row">
      <div class="hexagon">
        <div class="uai-in-hex"><span>UAI</span></div>
      </div>
    </div>
    <div style="background: #e3f0ff; border-left: 6px solid #2979ff; border-radius: 10px; padding: 18px 20px; margin-bottom: 28px; box-shadow: 0 2px 8px #2979ff22;">
      <h2 style="margin-top:0; color:#2979ff;">Note to All Admins</h2>
      <p style="font-size:1.1em; color:#222; margin-bottom: 10px;">
        All admins are encouraged to perform their tasks with <b>integrity</b>, <b>passion</b>, and <b>hard work</b>. Be creative!<br>
        <br>
        <b>Lead by Example:</b> Inspire your teams through your actions and commitment.<br>
        <b>Embrace Innovation:</b> Always look for new ways to improve and grow.<br>
        <b>Communicate Openly:</b> Foster a culture of transparency and trust.<br>
        <b>Support Each Other:</b> Collaboration and teamwork are the foundation of our success.<br>
        <b>Stay Accountable:</b> Take responsibility for your decisions and results.<br>
        <b>Never Stop Learning:</b> Growth comes from continuous improvement and adaptation.<br>
        <br>
        Together, let's build a legacy of excellence at UAI.
      </p>
      <div style="text-align:right; font-style:italic; color:#444; font-weight:600;">â€” C.E.O MR Newton Ooga</div>
    </div>
    <hr style="margin: 36px 0 24px 0; border: none; border-top: 2px solid #e3f0ff;">
    <div style="background: #fff; border-radius: 8px; padding: 16px 18px; box-shadow: 0 1px 4px #2979ff11;">
      <h3 style="margin-top:0; color:#2979ff;">HR Managers</h3>
      <div id="hr-booklet"></div>
    </div>
    <script>
      const userRole = localStorage.getItem('userRole');
      const userId = localStorage.getItem('userId');
      let hrManagers = [];
      async function fetchHRManagers() {
        try {
          const res = await fetch('/api/admin/hr-managers');
          if (!res.ok) throw new Error('Failed to fetch HR managers');
          hrManagers = await res.json();
          renderHRBooklet();
        } catch (err) {
          document.getElementById('hr-booklet').innerHTML = '<div style="color:#d32f2f;">Failed to load HR managers.</div>';
        }
      }
      async function verifyHR(id) {
        await fetch('/api/admin/verify-hr', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id })
        });
        fetchHRManagers();
      }
      async function rejectHR(id) {
        await fetch('/api/admin/reject-hr', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id })
        });
        fetchHRManagers();
      }
      function renderHRBooklet() {
        const container = document.getElementById('hr-booklet');
        container.innerHTML = '';
        hrManagers.forEach(row => {
          const isCEO = userRole === "CEO";
          const isSelf = userId == row.id && userRole === 'HR Manager';
          const blurStyle = 'filter: blur(6px); color: #aaa;';
          const card = document.createElement('div');
          card.style = 'border:1px solid #e3f0ff; border-radius:10px; margin-bottom:18px; padding:16px 14px; box-shadow:0 1px 4px #2979ff11; background:#f9fbff;';
          card.innerHTML = `
            <div style='font-weight:600; color:#2979ff; font-size:1.1em; margin-bottom:6px;'>${row.name}</div>
            <div style='margin-bottom:4px;'><b>ID Number:</b> <span style='${(isCEO || isSelf) ? '' : blurStyle}'>${row.id_number}</span></div>
            <div style='margin-bottom:4px;'><b>Mobile Number:</b> <span>${row.mobile}</span></div>
            <div style='margin-bottom:4px;'><b>Gmail:</b> <span style='${(isCEO || isSelf) ? '' : blurStyle}'>${row.gmail}</span></div>
            <div style='margin-bottom:8px;'><b>Position:</b> <span style='${(isCEO || isSelf) ? '' : blurStyle}'>${row.position}</span></div>
            ${(isCEO) ? `
              <button onclick='verifyHR(${row.id})' style='background:#2979ff; color:#fff; border:none; border-radius:6px; padding:6px 12px; cursor:pointer; margin-right:8px;'>${row.verified ? 'Verified' : 'Verify'}</button>
              <button onclick='rejectHR(${row.id})' style='background:#ff4444; color:#fff; border:none; border-radius:6px; padding:6px 12px; cursor:pointer;'>Reject</button>
            ` : ''}
          `;
          container.appendChild(card);
        });
      }
      fetchHRManagers();
      document.getElementById('logout-btn').addEventListener('click', function(e) {
        e.preventDefault();
        localStorage.clear();
        window.location.replace('index.html');
      });
      // Hide Control Panel link for non-CEO users
      if (localStorage.getItem('userRole') !== 'CEO') {
        var cpLink = document.getElementById('control-panel-link');
        if (cpLink) cpLink.style.display = 'none';
      }
    </script>
  </div>
</body>
</html>