<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Recharge Method 1 - UAI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #2979ff 0%, #ad7ce6 100%);
      margin: 0; padding: 0;
      min-height: 100vh;
      display: flex; flex-direction: column; align-items: center;
    }
    .container {
      background: rgba(255,255,255,0.96);
      margin-top: 60px;
      padding: 36px 24px 28px 24px;
      border-radius: 22px;
      max-width: 410px;
      width: 97vw;
      box-shadow: 0 2px 24px #ad7ce62a;
      text-align: center;
      position: relative;
    }
    .uai-logo {
      position: absolute;
      left: 50%; top: -38px;
      transform: translateX(-50%);
      width: 70px; height: 70px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ad7ce6 0%, #2979ff 100%);
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 2px 18px #7a09c555;
      border: 4px solid #fff;
    }
    .uai-logo span {
      color: #fff;
      font-size: 2em;
      font-weight: 800;
      letter-spacing: 3px;
      text-shadow: 0 2px 8px #7a09c577, 0 0 2px #4f2b7c;
    }
    h2 { color: #2979ff; margin-bottom: 1.5em;}
    .input-group { margin-bottom: 1.1em; text-align:left;}
    label { display: block; margin-bottom: 0.35em; color: #ad7ce6; font-weight: 600;}
    input[type="text"], input[type="number"] {
      width: 100%; padding: 10px 8px; border-radius: 9px; border: 1px solid #ad7ce6;
      font-size: 1em; margin-bottom: 0.7em; box-sizing: border-box;
    }
    .pay-btn {
      background: linear-gradient(90deg, #2979ff 0%, #ad7ce6 100%);
      color: #fff; border: none; border-radius: 14px; font-size: 1.09em;
      padding: 13px 22px; font-weight: 700; cursor: pointer; transition: background .18s;
      min-width: 110px;
      display: inline-block;
      box-shadow: 0 2px 10px #ad7ce655;
      outline: none;
      margin-top: 6px;
    }
    .pay-btn:active { background: #1565c0; }
    .message { margin-top: 1.2em; color: #2979ff; font-weight: 600; min-height: 24px;}
    .recharge-note {
      color: #ad7ce6;
      margin-bottom: 19px;
      font-size: 1.01em;
      font-style: italic;
      text-align: center;
    }
    @media (max-width:600px) {
      .container { padding: 18px 4vw 15px 4vw; }
      .uai-logo { width: 48px; height: 48px; top: -28px; }
      .uai-logo span { font-size: 1.15em;}
      h2 { font-size: 1.1em;}
    }
  </style>
</head>
<body>
<div class="container">
  <div class="uai-logo"><span>UAI</span></div>
  <h2>Recharge - Method 1 (STK Push)</h2>
  <div class="recharge-note">
    Enter your Mpesa number and amount. You'll receive a prompt on your phone to enter your Mpesa PIN.
  </div>
  <form id="form1">
    <div class="input-group">
      <label for="number">Mpesa Number</label>
      <input type="text" id="number" placeholder="e.g. 07XXXXXXXX" maxlength="15" required>
    </div>
    <div class="input-group">
      <label for="amount">Amount</label>
      <input type="number" id="amount" placeholder="Enter amount" min="10" required>
    </div>
    <button type="submit" class="pay-btn">Recharge</button>
  </form>
  <div class="message" id="message"></div>
</div>
<script>
  const userToken = localStorage.getItem('token');
  document.getElementById('form1').onsubmit = async function(e) {
    e.preventDefault();
    const number = document.getElementById('number').value.trim();
    const amount = document.getElementById('amount').value.trim();
    if (!number || !amount) {
      document.getElementById('message').style.color = "#c62828";
      document.getElementById('message').textContent = "Please enter your phone number and amount.";
      return;
    }
    document.getElementById('message').style.color = "#ad7ce6";
    document.getElementById('message').textContent = "Processing...";
    try {
      const res = await fetch('/api/recharge-method1', {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + userToken
        },
        body: JSON.stringify({ number, amount })
      });
      const data = await res.json();
      document.getElementById('message').style.color = data.message ? "#2979ff" : "#c62828";
      document.getElementById('message').textContent = data.message || data.error || "You will receive a prompt on your phone. Enter your Mpesa PIN to complete payment.";
    } catch (e) {
      document.getElementById('message').style.color = "#c62828";
      document.getElementById('message').textContent = "An error occurred.";
    }
  };
</script>
</body>
</html>